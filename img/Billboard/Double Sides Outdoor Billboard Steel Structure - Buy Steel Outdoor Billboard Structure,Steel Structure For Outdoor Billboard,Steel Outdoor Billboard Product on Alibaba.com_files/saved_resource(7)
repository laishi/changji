(function(){var e=function(){var e={},t={exports:e};(function(e,t){var require={resolve:function(e){return n+"/"+e}};var n=e.location.protocol+"//i.alicdn.com",a=require.resolve("sc-affiliate/sem-remarketing/proxy.8144c682.html?iframe_delete=true"),r="//offer.alibaba.com/product/fetchSiteTag.jsonp";var o={_postData:{},_bindEvent:function(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}},_initIframeProxy:function(){var e=document,t=e.body||e.documentElement,n="sem-remarketing",r=n,o=e.getElementById(n);if(o&&o.nodeType){return}o=e.createElement("iframe");o.id=n;o.name=r;o.style.display="none";o.style.visibility="hidden";o.src=a;t.appendChild(o)},_isEmptyObject:function(e){for(var t in e){return false}return true},_isP4P:function(){return/s=p/.test(location.href)},_isWap:function(){return(e.$client&&e.$client.client)!==t},_log:function(t){if(e.console&&e.console.log){e.console.log(t)}o._sendDomdot("26131","error="+t)},_send:function(){var t=e.SEM_REMARKETING_CONFIG||{},n=e.SEM_REMARKETING_DATA||{};if(t.sent){return false}if(o._isEmptyObject(n)){return false}t.sent=true;e.SEM_REMARKETING_CONFIG=t;n.isP4P=o._isP4P();n.pageDevice=o._isWap()?"Mobile":"PC";if(n.categoryId){n.categoryId=n.categoryId.split(",")[0]}if(n.productId){n.productId=n.productId.split(",")[0]}if(n.pageCate){n.pageCate=n.pageCate.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}if(n.pageName){n.pageName=n.pageName.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}var a={timeout:1e3*20,url:r,callback:"callback",data:{siteName:n.siteName||"",pageFrom:n.pageType||"",pageInfo:JSON.stringify(n),language:n.pageLanguage||""},success:function(e){if(!e||!e.success||!e.result){return false}var t=[].concat(e.result);if(t.length>0){o._postData=t;o._initIframeProxy();o._sendDomdot("26131","success")}},fail:function(e){o._log("SEMRSE-01-02")}};o._sendJsonp(a);o._sendDomdot("26131","initialization")},_sendByIframeProxy:function(e){var t=e.data,a=t.split(":")[0],r=t.split(":")[1];if(e.origin!=n){return false}if(a=="ready"){var i=JSON.stringify(o._postData);if(e.source&&e.source.postMessage){e.source.postMessage(i,n)}}else if(a=="error"){o._log(r)}else if(a=="complete"){o._sendDomdot("26254",r)}},_sendDomdot:function(t,n){var a=e.SEM_REMARKETING_DATA&&e.SEM_REMARKETING_DATA.pageType,r={ext:"event="+a+"|"+n,mn:"sem"};if(e.dmtrack&&e.dmtrack.dotstat&&e.dmtrack_pageid&&t){e.dmtrack.dotstat(t,r)}},_sendJsonp:function(t){t=t||{};if(!t.url||!t.callback){throw new Error("params error!")}var n=t.data[t.callback]="jsonp_"+new Date*1+""+Math.ceil(Math.random()*1e5),a=o._toQueryString(t.data,"&"),r=document.createElement("script"),i=document.getElementsByTagName("head")[0];i.appendChild(r);e[n]=function(a){i.removeChild(r);clearTimeout(r.timer);e[n]=function(){};t.success&&t.success(a)};r.src=t.url+"?"+a;if(t.timeout){r.timer=setTimeout(function(){e[n]=function(){};i.removeChild(r);t.fail&&t.fail({message:"overtime"})},t.timeout)}},_toQueryString:function(e,t){var n,a,r=[];if(!e){return""}for(n in e){a=e[n]||"";r.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}return r.join(t||"&")}};try{if(e.postMessage){o._bindEvent(e,"message",o._sendByIframeProxy);var i=e.SEM_REMARKETING_CONFIG||{};if(i.runtime=="async"){o._send()}else{o._bindEvent(e,"load",o._send)}}else{o._log("SEMRSE-01-01")}}catch(s){o._log("SEMRSE-01-00")}})(window);return t.exports}()})();;
